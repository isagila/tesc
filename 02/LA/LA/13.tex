\question{Квадратичная форма: определения, приведение к каноническому виду.}

\begin{definition}
  Числовая функция одного аргумента \(\Quad(u) \mid u \in V^{n}\), которая
  порождается билинейной формой \(\BiLinear(u, v)\) при \(u = v\) называется
  квадратичной формой.

  \begin{align*}
    \Quad(u) = \BiLinear(u, u)
  \end{align*}
\end{definition}

\begin{remark}
  Если квадратичная форма порождена симметричной билинейной формой, то эта
  билинейная форма называется полярной для квадратичной.
\end{remark}

\begin{definition}
  Каноническим видом квадратичной формы \(\Quad^{d}(u)\) является сумма
  квадратов с некоторыми коэффициентами.

  \begin{align*}
    \Quad^{d}(u) = \lambda_{1} u_{1}^{2} + \dotsc + \lambda_{n} u_{n}^{2}
  \end{align*}

  Причем \(\lambda_{i}\) называются каноническими коэффициентами.
\end{definition}

\begin{definition}
  Если в каноническом виде все коэффициенты \(\lambda_{i}\) равны \(\pm 1\) или
  \(0\), то такой вид называется нормальным.
\end{definition}

\begin{definition}
  Базис, в котором квадратичная форма является канонической, называется
  каноническим базисом.
\end{definition}

\begin{remark}
  Канонический базис не единственный.
\end{remark}

\begin{remark}
  Пусть квадратичная форма задана в виде

  \begin{align*}
    \Quad(u)
    = a_{1,1} u_{1}^2 + \dotsc + a_{n,n} u_{n}^2
    + 2 a_{1,2} u_{1} u_{2} + \dotsc + 2 a_{1,n} u_{1} u_{n}
    + \dotsc
    + 2 a_{n,1} u_{n} u_{1} + \dotsc + 2 a_{n,n - 1} u_{n} u_{n - 1}
  \end{align*}

  тогда её матрица будет иметь вид

  \begin{align*}
    \begin{pmatrix}
      a_{1,1} & \dots  & a_{1,n} \\
      \vdots  & \ddots & \vdots \\
      a_{n,1} & \dots  & a_{n,n} \\
    \end{pmatrix}
  \end{align*}
\end{remark}

\begin{theorem}
  Всякую квадратичную форму \(\Quad(u)\) можно привести к каноническому
  виду невырожденным преобразованием.
\end{theorem}

\underline{Метод Лагранжа}:

Один из способов приведения квадратичной формы к каноническому виду.

Рассмотрим его на примере \(
  \Quad(x)
  = x_{1}^2 + 9 x_{2}^2 + x_{3}^2
  + 6 x_{1} x_{2} + 2 x_{1} x_{3} + 2 x_{2} x_{3}
\)

Метод заключается в последовательном выделении полных квадратов:

\begin{align*}
  x_{1}^2 + 9 x_{2}^2 + x_{3}^2 +
  6 x_{1} x_{2} + 2 x_{1} x_{3} + 2 x_{2} x_{3}
  \\
  x_{1}^2 + 2 x_{1} (3 x_{2} + x_{3}) + 9 x_{2}^2 + x_{3}^2 + 2 x_{2} x_{3}
  \\
  \Big( x_{1}^2 + 2 x_{1} (3 x_{2} + x_{3}) + (3 x_{2} + x_{3})^2 \Big)
  - (3 x_{2} + x_{3})^2 + 9 x_{2}^2 + x_{3}^2 + 2 x_{2} x_{3}
  \\
  (x_{1} + 3 x_{2} + x_{3})^2
  - 9 x_{2}^2 - 6 x_{2} x_{3} - x_{3}^2
  + 9 x_{2}^2 + x_{3}^2 + 2 x_{2} x_{3} 
  \\
  (x_{1} + 3 x_{2} + x_{3})^2 - 4 x_{2} x_{3} 
\end{align*}

Далее делаем замену

\begin{align*}
  \begin{cases}
    y_{1} = x_{1} + 3 x_{2} + x_{3} \\
    y_{2} = \frac{1}{2} (x_{2} + x_{3}) \\
    y_{3} = \frac{1}{2} (x_{2} - x_{3})
  \end{cases}
\end{align*}

Замены \(y_{2}\) и \(y_{3}\) именно такие, потому что остался моном
\(- 4 x_{2} x_{3}\), из которого мы не можем выделить полный квадрат.

\begin{align*}
  \begin{cases}
    y_{2} = \frac{1}{2} (x_{2} + x_{3}) \\
    y_{3} = \frac{1}{2} (x_{2} - x_{3})
  \end{cases}
  \implies
  \begin{cases}
    x_{2} = y_{2} + y_{3} \\
    x_{3} = y_{2} - y_{3}  
  \end{cases} \\
  (x_{1} + 3 x_{2} + x_{3})^2 - 4 x_{2} x_{3}  \\
  y_{1}^2 - 4 (y_{2} + y_{3}) (y_{2} - y_{3}) \\
  y_{1}^2 - 4 (y_{2}^2 - y_{3}^2) \\
  y_{1}^2 - 4 y_{2}^2 + 4 y_{3}^2 \\
\end{align*}

Таким образом, получен канонический вид квадратичной формы 
\(\Quad^{d}(y) = y_{1}^2 - 4 y_{2}^2 + 4 y_{3}^2\).

Матрицу полученного преобразования можно получить из уравнения \(x = P y\), для
этого обратимся к сделанной замене и найдем обратную матрицу:

\begin{align*}
  y = \begin{pmatrix}
    1 & 3            & 1             \\
    0 & \sfrac{1}{2} & \sfrac{1}{2}  \\
    0 & \sfrac{1}{2} & -\sfrac{1}{2}
  \end{pmatrix}
  x
  \\
  x = \begin{pmatrix}
    1 & 3            & 1             \\
    0 & \sfrac{1}{2} & \sfrac{1}{2}  \\
    0 & \sfrac{1}{2} & -\sfrac{1}{2}
  \end{pmatrix}^{-1}
  y
  \\
  P = \begin{pmatrix}
    1 & -4 & -2 \\
    0 &  1 &  1 \\
    0 &  1 & -1
  \end{pmatrix}
\end{align*}

Пусть \(K\) это матрица квадратичной формы \(\Quad(x)\) в исходном базисе, а
\(K^{d}\)~--- в каноническом. Тогда проверить корректность найденной матрицы
преобразования можно следующим образом:

\begin{align*}
  K^{d} = P^{T} K P = 
  \begin{pmatrix}
    1  & 0 &  0 \\
    -4 & 1 &  1 \\
    -2 & 1 & -1
  \end{pmatrix}
  \begin{pmatrix}
    1 & 3 & 1 \\
    3 & 9 & 1 \\
    1 & 1 & 1
  \end{pmatrix}
  \begin{pmatrix}
    1 & -4 & -2 \\
    0 &  1 &  1 \\
    0 &  1 & -1
  \end{pmatrix}
  =
  \begin{pmatrix}
    1 &  0 & 0 \\
    0 & -4 & 0 \\
    0 &  0 & 4
  \end{pmatrix}
\end{align*}

\underline{Ортоногальное преобразование}:

Метод, позволяющий привести квадратичную форму к каноническому виду с
помощью ортогонального преобразования.

Рассмотрим его на примере \(\Quad(x) = x_{1}^2 + x_{2}^2 - 4 x_{1} x_{2}\).

Сначала составим матрицу квадратичной формы, после чего найдем её собственные
числа и собственные векторы:

\begin{align*}
  \begin{pmatrix}
     1 & -2 \\
    -2 & 1
  \end{pmatrix}
  \implies
  \begin{cases}
    \lambda_{1} = -1 \\
    \lambda_{2} = 3
  \end{cases}
  \implies
  \begin{cases}
    \basis_{1} = \begin{pmatrix} 1 \\ 1 \end{pmatrix} \\
    \basis_{2} = \begin{pmatrix} 1 \\ -1 \end{pmatrix}
  \end{cases}
\end{align*}

Найденные собственные числа будут коэффициентами при квадратах в диагональном
виде квадратичной формы \(\Quad^{d}(y) = -y_{1}^2 + 3 y_{2}^2\).

Далее нормируем полученные собственные векторы и используем их как столбцы
матрицы ортогонального преобразования \(P\):

\begin{align*}
  \begin{cases}
    \basis_{1} = \begin{pmatrix} 1 \\ 1 \end{pmatrix} \\
    \basis_{2} = \begin{pmatrix} 1 \\ -1 \end{pmatrix}
  \end{cases}
  \implies
  \begin{cases}
    \widehat{\basis_{1}} = \begin{pmatrix}
      \sfrac{1}{\sqrt{2}} \\
      \sfrac{1}{\sqrt{2}}
    \end{pmatrix}
    \\
    \widehat{\basis_{2}} = \begin{pmatrix}
      \sfrac{1}{\sqrt{2}} \\
      \sfrac{-1}{\sqrt{2}}
    \end{pmatrix}
  \end{cases}
  \implies
  P = \begin{pmatrix}
    \sfrac{1}{\sqrt{2}} & \sfrac{1}{\sqrt{2}} \\
    \sfrac{1}{\sqrt{2}} & \sfrac{-1}{\sqrt{2}} \\
  \end{pmatrix}
\end{align*}

\begin{remark}
  Ранг матрицы квадратичной формы это инвариант относительно любого
  невырожденного преобразования.
\end{remark}
